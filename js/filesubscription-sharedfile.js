!function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="/apps/filesubscription/js/",e(e.s=7)}([function(t,n,e){"use strict";var o,i=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},r=function(){var t={};return function(n){if(void 0===t[n]){var e=document.querySelector(n);if(window.HTMLIFrameElement&&e instanceof window.HTMLIFrameElement)try{e=e.contentDocument.head}catch(t){e=null}t[n]=e}return t[n]}}(),a=[];function s(t){for(var n=-1,e=0;e<a.length;e++)if(a[e].identifier===t){n=e;break}return n}function c(t,n){for(var e={},o=[],i=0;i<t.length;i++){var r=t[i],c=n.base?r[0]+n.base:r[0],l=e[c]||0,u="".concat(c," ").concat(l);e[c]=l+1;var p=s(u),d={css:r[1],media:r[2],sourceMap:r[3]};-1!==p?(a[p].references++,a[p].updater(d)):a.push({identifier:u,updater:f(d,n),references:1}),o.push(u)}return o}function l(t){var n=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var i=e.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach((function(t){n.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(n);else{var a=r(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}return n}var u,p=(u=[],function(t,n){return u[t]=n,u.filter(Boolean).join("\n")});function d(t,n,e,o){var i=e?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=p(n,i);else{var r=document.createTextNode(i),a=t.childNodes;a[n]&&t.removeChild(a[n]),a.length?t.insertBefore(r,a[n]):t.appendChild(r)}}function A(t,n,e){var o=e.css,i=e.media,r=e.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var m=null,b=0;function f(t,n){var e,o,i;if(n.singleton){var r=b++;e=m||(m=l(n)),o=d.bind(null,e,r,!1),i=d.bind(null,e,r,!0)}else e=l(n),o=A.bind(null,e,n),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)};return o(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;o(t=n)}else i()}}t.exports=function(t,n){(n=n||{}).singleton||"boolean"==typeof n.singleton||(n.singleton=i());var e=c(t=t||[],n);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<e.length;o++){var i=s(e[o]);a[i].references--}for(var r=c(t,n),l=0;l<e.length;l++){var u=s(e[l]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}e=r}}}},function(t,n,e){"use strict";function o(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==e)return;var o,i,r=[],a=!0,s=!1;try{for(e=e.call(t);!(a=(o=e.next()).done)&&(r.push(o.value),!n||r.length!==n);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==e.return||e.return()}finally{if(s)throw i}}return r}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return i(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return i(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}t.exports=function(t){var n=o(t,4),e=n[1],i=n[3];if(!i)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),s="/*# ".concat(a," */"),c=i.sources.map((function(t){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(t," */")}));return[e].concat(c).concat([s]).join("\n")}return[e].join("\n")}},function(t,n,e){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var e=t(n);return n[2]?"@media ".concat(n[2]," {").concat(e,"}"):e})).join("")},n.i=function(t,e,o){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(o)for(var r=0;r<this.length;r++){var a=this[r][0];null!=a&&(i[a]=!0)}for(var s=0;s<t.length;s++){var c=[].concat(t[s]);o&&i[c[0]]||(e&&(c[2]?c[2]="".concat(e," and ").concat(c[2]):c[2]=e),n.push(c))}},n}},,function(t,n,e){"use strict";var o=e(1),i=e.n(o),r=e(2),a=e.n(r)()(i.a);a.push([t.i,"#subscription-icon{display:flex;justify-content:center;align-items:center;width:50px;height:100%;cursor:pointer;opacity:0.6;padding:0;margin:0}#subscription-content .content{padding:1rem;min-width:220px}#subscription-content .content>h3{font-weight:bold;text-align:center}#subscription-content .content>div:nth-child(even){margin-bottom:1rem;border-bottom:1px solid var(--color-border)}#subscription-content .content em{display:block;line-height:19px;font-size:12px}#subscription-content .content form#subscription-mail{margin-top:1rem;display:flex;justify-content:center;align-items:center;flex:1 1 auto}#subscription-content .content form#subscription-mail input[type=email]{width:100%;border-color:var(--color-border-dark)}#subscription-content .content form#subscription-mail input[type=email]+label.icon-confirm{border-color:var(--color-border-dark) !important;border-left-color:transparent !important;border-style:solid;border-width:1px;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}#subscription-content .content form#subscription-mail input[type=email]:focus:invalid{border-color:crimson}#subscription-content .content form#subscription-mail input[type=email]:focus:invalid+label.icon-confirm{border-color:crimson !important;border-left-color:transparent !important;border-style:solid;border-width:1px;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}#subscription-content .content form#subscription-mail input[type=email]:focus:valid{border-color:#6495ed}#subscription-content .content form#subscription-mail input[type=email]:focus:valid+label.icon-confirm{border-color:#6495ed !important;border-left-color:transparent !important;border-style:solid;border-width:1px;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}#subscription-content .content form#subscription-mail input[type=email]:hover{border-color:#a9a9a9}#subscription-content .content form#subscription-mail input[type=email]:hover+label.icon-confirm{border-color:#a9a9a9 !important;border-left-color:transparent !important;border-style:solid;border-width:1px;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}#subscription-content .content form#subscription-mail input[type=email]:active{border-color:#000}#subscription-content .content form#subscription-mail input[type=email]:active+label.icon-confirm{border-color:#000 !important;border-left-color:transparent !important;border-style:solid;border-width:1px;border-top-left-radius:0 !important;border-bottom-left-radius:0 !important}#subscription-content .content form#subscription-mail label.icon-confirm{box-sizing:border-box}#subscription-content .content form#subscription-mail label.icon-confirm:hover{background-position-x:60%}#subscription-content .content form#subscription-mail label.icon-confirm:active{background-position-y:55%}#subscription-content .content div#subscription-api{display:flex;margin-top:15px}#subscription-content .content div#subscription-api button{margin-left:2px}#subscription-content .content div#subscription-api input{width:100%}#subscription-content #subscription-mail+div{margin-bottom:1rem}#subscription-content #subscription-mail+div a{color:gray;text-decoration:underline}#subscription-content #subscription-mail+div a:hover{color:black}#subscription-content .msg{color:#000;padding:3px}#subscription-content .msg.success{color:#fff;background-color:#47a447}#subscription-content .msg.error{color:#fff;background-color:#d2322d}\n","",{version:3,sources:["webpack://./css/sharedfile.scss"],names:[],mappings:"AAAA,mBACI,YAAa,CACb,sBAAuB,CACvB,kBAAmB,CACnB,UAAW,CACX,WAAY,CACZ,cAAe,CACf,WAAY,CACZ,SAAU,CACV,QAAS,CACZ,+BAIO,YAAa,CACb,eAAgB,CAHxB,kCAKY,gBAAiB,CACjB,iBAAkB,CAN9B,mDASY,kBAAmB,CACnB,2CAA4C,CAVxD,kCAaY,aAAc,CACd,gBAAiB,CACjB,cAAe,CAf3B,sDAkBY,eAAgB,CAChB,YAAa,CACb,sBAAuB,CACvB,kBAAmB,CACnB,aAAc,CAtB1B,wEAqCgB,UAAW,CAZX,qCAa6C,CAtC7D,2FA2BoB,gDAA+B,CAC/B,wCAAyC,CACzC,kBAAmB,CACnB,gBAAiB,CACjB,mCAAoC,CACpC,sCAAuC,CAhC3D,sFAyBgB,oBAe8C,CAxC9D,yGA2BoB,+BAA+B,CAC/B,wCAAyC,CACzC,kBAAmB,CACnB,gBAAiB,CACjB,mCAAoC,CACpC,sCAAuC,CAhC3D,oFAyBgB,oBAgBmD,CAzCnE,uGA2BoB,+BAA+B,CAC/B,wCAAyC,CACzC,kBAAmB,CACnB,gBAAiB,CACjB,mCAAoC,CACpC,sCAAuC,CAhC3D,8EAyBgB,oBAiBuC,CA1CvD,iGA2BoB,+BAA+B,CAC/B,wCAAyC,CACzC,kBAAmB,CACnB,gBAAiB,CACjB,mCAAoC,CACpC,sCAAuC,CAhC3D,+EAyBgB,iBAkBqC,CA3CrD,kGA2BoB,4BAA+B,CAC/B,wCAAyC,CACzC,kBAAmB,CACnB,gBAAiB,CACjB,mCAAoC,CACpC,sCAAuC,CAhC3D,yEA+CgB,qBAAsB,CA/CtC,+EAiDoB,yBACJ,CAlDhB,gFAoDoB,yBACJ,CArDhB,oDAyDY,YAAa,CACb,eAAgB,CA1D5B,2DA4DgB,eAAgB,CA5DhC,0DA+DgB,UAAW,CA/D3B,6CAsEQ,kBAAmB,CAtE3B,+CAwEY,UAAW,CACX,yBAA0B,CAzEtC,qDA2EgB,WAAY,CA3E5B,2BAiFQ,UAAW,CACX,WAAY,CAlFpB,mCAoFY,UAAW,CACX,wBAAyB,CArFrC,iCAwFY,UAAW,CACX,wBAAyB",sourcesContent:["#subscription-icon {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 50px;\n    height: 100%;\n    cursor: pointer;\n    opacity: 0.6;\n    padding: 0;\n    margin: 0;\n}\n\n#subscription-content {\n    .content {\n        padding: 1rem;\n        min-width: 220px;\n        & > h3 {\n            font-weight: bold;\n            text-align: center;\n        }\n        & > div:nth-child(even) {\n            margin-bottom: 1rem;\n            border-bottom: 1px solid var(--color-border);\n        }\n        em {\n            display: block;\n            line-height: 19px;\n            font-size: 12px;\n        }\n        form#subscription-mail {\n            margin-top: 1rem;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            flex: 1 1 auto;\n\n            @mixin borderStyle($color) {\n                border-color: $color;\n                & + label.icon-confirm {\n                    border-color: $color !important;\n                    border-left-color: transparent !important;\n                    border-style: solid;\n                    border-width: 1px;\n                    border-top-left-radius: 0 !important;\n                    border-bottom-left-radius: 0 !important;\n                }\n            }\n\n            input[type=email] {\n                width: 100%;\n                @include borderStyle(var(--color-border-dark));\n\n                &:focus:invalid { @include borderStyle(crimson); }\n                &:focus:valid { @include borderStyle(cornflowerblue); }\n                &:hover { @include borderStyle(darkgray); }\n                &:active { @include borderStyle(black); }\n            }\n\n            label.icon-confirm {\n                box-sizing: border-box;\n                &:hover {\n                    background-position-x: 60%\n                }\n                &:active {\n                    background-position-y: 55%\n                }\n            }\n        }\n        div#subscription-api {\n            display: flex;\n            margin-top: 15px;\n            button {\n                margin-left: 2px;\n            }\n            input {\n                width: 100%;\n            }\n        }\n    }\n\n    // unsubscr\n    #subscription-mail + div {\n        margin-bottom: 1rem;\n        a {\n            color: gray;\n            text-decoration: underline;\n            &:hover {\n                color: black;\n            }\n        }\n    }\n\n    .msg {\n        color: #000;\n        padding: 3px;\n        &.success {\n            color: #fff;\n            background-color: #47a447;\n        }\n        &.error {\n            color: #fff;\n            background-color: #d2322d;\n        }\n    }\n}\n"],sourceRoot:""}]),n.a=a},,,function(n,e,o){"use strict";o.r(e);var i=o(0),r=o.n(i),a=o(4),s={insert:"head",singleton:!1},c=(r()(a.a,s),a.a.locals,{appId:"filesubscription",sharingToken:$("#sharingToken").val(),init:function(){var n=document.querySelector("#header .header-right");if(!document.getElementById("filesubscription-header")){var e=document.createElement("div");e.id="filesubscription-header",n.insertBefore(e,n.firstChild);var o=OCA.FileSubscription.Templates["sharedfile-header"]({title:t(this.appId,"Subscription"),description:t(this.appId,"Subscribe this file to get the new version of the file and modification instructions."),placeholder:t(this.appId,"Enter your email"),unsubscribe:t(this.appId,"Unsubscribe")});this._getApiCode(),$("#filesubscription-header").append(o),$("#subscription-icon").on("click",this._onOpenEvent.bind(this)),$("form#subscription-mail").on("submit",this._onConfirmEvent.bind(this)),$("a#unsubscr").on("click",this._onUnsubscrEvent.bind(this)),$("#subscription-api").on("click","input#apicode, button",this._selectCopy.bind(this))}},_onOpenEvent:function(t){t.stopPropagation(),$("#subscription-content").toggle()},_onConfirmEvent:function(n){n.stopPropagation(),n.preventDefault();var e=$("#subscription-content .msg"),o={status:"",data:{message:""}},i=this.sharingToken,r=$('form#subscription-mail input[name="email"]').val();if(""===r)return o.data.message=t(this.appId,"Please enter Email"),void OC.msg.finishedAction(e,o);$.ajax({context:this,url:OC.generateUrl("/apps/".concat(this.appId,"/subscribe")),type:"POST",data:{token:i,mailAddr:r},beforeSend:function(){$("form#subscription-mail input").attr("disabled","disabled"),OC.msg.startAction(e,t(this.appId,"Setting..."))}}).done((function(){o.data.message=t(this.appId,"Subscribed"),o.status="success",$('form#subscription-mail input[name="email"]').val("")})).fail((function(n){o.data.message=t(this.appId,"Unable to subscribe"),void 0!==n.responseJSON.message&&(o.data.message+=": ",o.data.message+=n.responseJSON.message)})).always((function(t){OC.msg.finishedAction(e,o),$("form#subscription-mail input").removeAttr("disabled")}))},_onUnsubscrEvent:function(n){n.stopPropagation(),n.preventDefault();var e=$("#subscription-content .msg"),o={status:"",data:{message:""}},i=this.sharingToken,r=$('form#subscription-mail input[name="email"]').val();if(""===r)return o.data.message=t(this.appId,"Please enter Email"),void OC.msg.finishedAction(e,o);$.ajax({context:this,url:OC.generateUrl("/apps/".concat(this.appId,"/subscribe")),type:"DELETE",data:{token:i,mailAddr:r},beforeSend:function(){$("form#subscription-mail input").attr("disabled","disabled"),OC.msg.startAction(e,t(this.appId,"Setting..."))}}).done((function(){o.data.message=t(this.appId,"Unsubscribed"),o.status="success",$('form#subscription-mail input[name="email"]').val("")})).fail((function(n){o.data.message=t(this.appId,"Unable to unsubscribe"),void 0!==n.responseJSON.message&&(o.data.message+=": ",o.data.message+=n.responseJSON.message)})).always((function(t){OC.msg.finishedAction(e,o),$("form#subscription-mail input").removeAttr("disabled")}))},_selectCopy:function(t){var n=document.getElementById("apicode");n&&(n.select(),"BUTTON"===t.target.tagName&&document.execCommand("copy"))},_getApiCode:function(){$.ajax({url:OC.generateUrl("/apps/".concat(this.appId,"/apicode/").concat(this.sharingToken)),type:"GET"}).done((function(t){t&&($("#apicode").val(t),$("#subscription-api").parent("div").show())})).fail((function(t){}))}});OCA.FileSubscription||(OCA.FileSubscription={}),OCA.FileSubscription.Templates={},OCA.FileSubscription.SharedFile=c,window.addEventListener("DOMContentLoaded",(function(){document.getElementById("isPublic")&&"1"===document.getElementById("isPublic").value&&OCA.FileSubscription.SharedFile.init()}))}]);